import{r as l}from"./index-D4lIrffr.js";import{a as Po,g as ho,c as go}from"./generateUtilityClasses-CPRdC64H.js";import{u as C}from"./useSlot-aXQ8NPmW.js";import{j as T}from"./jsx-runtime-D_zvdyIk.js";import{u as vo,c as yo}from"./DefaultPropsProvider-CvIgHTDT.js";import{o as X}from"./ownerDocument-DW-IO8s5.js";import{o as Y}from"./ownerWindow-HkKU3E4x.js";import{d as wo}from"./debounce-Be36O1Ab.js";import{G as bo}from"./Grow-CLdI9-lF.js";import{m as xo}from"./mergeSlotProps-uRZWNtH4.js";import{s as Q}from"./styled-E20cg9_9.js";import{M as Eo}from"./Modal-CnnQW7as.js";import{P as So}from"./Paper-LH0oToZ1.js";function Co(t){return typeof t=="string"}function To(t){return Po("MuiPopover",t)}ho("MuiPopover",["root","paper"]);function q(t,r){let i=0;return typeof r=="number"?i=r:r==="center"?i=t.height/2:r==="bottom"&&(i=t.height),i}function J(t,r){let i=0;return typeof r=="number"?i=r:r==="center"?i=t.width/2:r==="right"&&(i=t.width),i}function K(t){return[t.horizontal,t.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function w(t){return typeof t=="function"?t():t}const Oo=t=>{const{classes:r}=t;return yo({root:["root"],paper:["paper"]},To,r)},ko=Q(Eo,{name:"MuiPopover",slot:"Root"})({}),zo=Q(So,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Io=l.forwardRef(function(r,i){const O=vo({props:r,name:"MuiPopover"}),{action:Z,anchorEl:p,anchorOrigin:d={vertical:"top",horizontal:"left"},anchorPosition:k,anchorReference:P="anchorEl",children:_,className:oo,container:to,elevation:z=8,marginThreshold:s=16,open:f,PaperProps:eo={},slots:R={},slotProps:y={},transformOrigin:h={vertical:"top",horizontal:"left"},TransitionComponent:M,transitionDuration:b="auto",TransitionProps:W={},disableScrollLock:x=!1,...ro}=O,E=l.useRef(),g={...O,anchorOrigin:d,anchorReference:P,elevation:z,marginThreshold:s,transformOrigin:h,TransitionComponent:M,transitionDuration:b,TransitionProps:W},j=Oo(g),D=l.useCallback(()=>{if(P==="anchorPosition")return k;const o=w(p),e=(o&&o.nodeType===1?o:X(E.current).body).getBoundingClientRect();return{top:e.top+q(e,d.vertical),left:e.left+J(e,d.horizontal)}},[p,d.horizontal,d.vertical,k,P]),H=l.useCallback(o=>({vertical:q(o,h.vertical),horizontal:J(o,h.horizontal)}),[h.horizontal,h.vertical]),L=l.useCallback(o=>{const n={width:o.offsetWidth,height:o.offsetHeight},e=H(n);if(P==="none")return{top:null,left:null,transformOrigin:K(e)};const v=D();let u=v.top-e.vertical,m=v.left-e.horizontal;const $=u+n.height,G=m+n.width,I=Y(w(p)),B=I.innerHeight-s,V=I.innerWidth-s;if(s!==null&&u<s){const a=u-s;u-=a,e.vertical+=a}else if(s!==null&&$>B){const a=$-B;u-=a,e.vertical+=a}if(s!==null&&m<s){const a=m-s;m-=a,e.horizontal+=a}else if(G>V){const a=G-V;m-=a,e.horizontal+=a}return{top:`${Math.round(u)}px`,left:`${Math.round(m)}px`,transformOrigin:K(e)}},[p,P,D,H,s]),[no,A]=l.useState(f),c=l.useCallback(()=>{const o=E.current;if(!o)return;const n=L(o);n.top!==null&&o.style.setProperty("top",n.top),n.left!==null&&(o.style.left=n.left),o.style.transformOrigin=n.transformOrigin,A(!0)},[L]);l.useEffect(()=>(x&&window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)),[p,x,c]);const io=()=>{c()},so=()=>{A(!1)};l.useEffect(()=>{f&&c()}),l.useImperativeHandle(Z,()=>f?{updatePosition:()=>{c()}}:null,[f,c]),l.useEffect(()=>{if(!f)return;const o=wo(()=>{c()}),n=Y(w(p));return n.addEventListener("resize",o),()=>{o.clear(),n.removeEventListener("resize",o)}},[p,f,c]);let F=b;const S={slots:{transition:M,...R},slotProps:{transition:W,paper:eo,...y}},[U,ao]=C("transition",{elementType:bo,externalForwardedProps:S,ownerState:g,getSlotProps:o=>({...o,onEntering:(n,e)=>{var v;(v=o.onEntering)==null||v.call(o,n,e),io()},onExited:n=>{var e;(e=o.onExited)==null||e.call(o,n),so()}}),additionalProps:{appear:!0,in:f}});b==="auto"&&!U.muiSupportAuto&&(F=void 0);const lo=to||(p?X(w(p)).body:void 0),[N,{slots:po,slotProps:co,...fo}]=C("root",{ref:i,elementType:ko,externalForwardedProps:{...S,...ro},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:R.backdrop},slotProps:{backdrop:xo(typeof y.backdrop=="function"?y.backdrop(g):y.backdrop,{invisible:!0})},container:lo,open:f},ownerState:g,className:go(j.root,oo)}),[uo,mo]=C("paper",{ref:E,className:j.paper,elementType:zo,externalForwardedProps:S,shouldForwardComponentProp:!0,additionalProps:{elevation:z,style:no?void 0:{opacity:0}},ownerState:g});return T.jsx(N,{...fo,...!Co(N)&&{slots:po,slotProps:co,disableScrollLock:x},children:T.jsx(U,{...ao,timeout:F,children:T.jsx(uo,{...mo,children:_})})})});export{Io as P};
